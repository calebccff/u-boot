// SPDX-License-Identifier: GPL-2.0+
/*
 * Qualcomm Robotics RB3 Development (dragonboard845c) board device
 * tree source
 *
 * (C) Copyright 2022 Sumit Garg <sumit.garg@linaro.org>
 */

/dts-v1/;

#include "sdm845.dtsi"
#include "pm8998.dtsi"

/ {
	model = "Thundercomm Dragonboard 845c";
	compatible = "thundercomm,db845c", "qcom,sdm845";

	chosen {
		stdout-path = "serial0:115200n8";
	};

	aliases {
		serial0 = &uart9;
	};

	pcie_usb_dual_pwr: vldo-3v3-regulator {
		compatible = "regulator-gpio";
		regulator-name = "VLDO_3V3";

		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;

		enable-gpios = <&tlmm 90 GPIO_ACTIVE_HIGH>;
		enable-active-high;
		states = <0 0>, <1800000 1>;
	};
};

&uart9 {
	status = "okay";
};

&pm8998_pon {
	key_vol_down {
		gpios = <&pm8998_pon 1 0>;
		label = "key_vol_down";
	};
	key_power {
		gpios = <&pm8998_pon 0 0>;
		label = "key_power";
	};
};

&sdhc_2 {
	status = "okay";

	clocks = <&gcc GCC_SDCC2_AHB_CLK>,
		 <&gcc GCC_SDCC2_APPS_CLK>;
	clock-names = "iface", "core";

	bus-width = <4>;
	cd-gpios = <&tlmm 126 GPIO_ACTIVE_LOW>;
};

&usb_2 {
	status = "okay";
	qcom,select-utmi-as-pipe-clk;
};

&usb_2_dwc3 {
	dr_mode = "host";

	/* We don't support superspeed in u-boot so remove the SSPHY */
	phys = <&usb_2_hsphy>;
	phy-names = "usb2-phy";

	/* fastest mode for USB 2 */
	maximum-speed = "high-speed";

	vbus-supply = <&pcie_usb_dual_pwr>;
};

&usb_2_hsphy {
	/* Remove ref clk because rmphcc isn't available */
	clocks = <&gcc GCC_USB_PHY_CFG_AHB2PHY_CLK>;
	clock-names = "cfg_ahb";

	status = "okay";
};

&tlmm {
	// pcie0_pwren_state: pcie0-usb-pwr-en {
	// 	pins = "gpio90";
	// 	drive-strength = <2>;
	// 	function = "gpio";
	// 	bias-disable;
	// };
};
